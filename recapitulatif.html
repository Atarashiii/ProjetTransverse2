<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Récapitulatif des Réponses</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <h2>Récapitulatif des Réponses</h2>
    <div id="recapitulatif">
        <h2>Axe Compétences</h2>
        <h3>Catégorie : Satisfaction</h3>
        <p>Question 1 : <span id="reponse-satisfaction_q1"></span></p>
        <p>Question 2 : <span id="reponse-satisfaction_q2"></span></p>
        <h3>Catégorie : Produit</h3>
        <p>Question 1 : <span id="reponse-produit_q1"></span></p>
        <p>Question 2 : <span id="reponse-produit_q2"></span></p>
        <h3>Catégorie : Recommandation</h3>
        <p>Question 1 : <span id="reponse-recommandation_q1"></span></p>
        <p>Question 2 : <span id="reponse-recommandation_q2"></span></p>
    </div>
    <button onclick="exporterImage()">Exporter en Image</button>
    <button onclick="exporterCSV()">Exporter en CSV</button>

    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            // Récupérer les réponses du localStorage
            var cq1 = document.querySelector('input[name="cq1"]:checked') ? document.querySelector('input[name="cq1"]:checked').value : '';
            var cq2 = document.querySelector('input[name="cq2"]:checked') ? document.querySelector('input[name="cq2"]:checked').value : '';
            var cq3 = document.querySelector('input[name="cq3"]:checked') ? document.querySelector('input[name="cq3"]:checked').value : '';
            var cq4 = document.querySelector('input[name="cq4"]:checked') ? document.querySelector('input[name="cq4"]:checked').value : '';
            var cq5 = document.querySelector('input[name="cq5"]:checked') ? document.querySelector('input[name="cq5"]:checked').value : '';
            var cq6 = document.querySelector('input[name="cq6"]:checked') ? document.querySelector('input[name="cq6"]:checked').value : '';
            var cq7 = document.querySelector('input[name="cq7"]:checked') ? document.querySelector('input[name="cq7"]:checked').value : '';
            var cq8 = document.querySelector('input[name="cq8"]:checked') ? document.querySelector('input[name="cq8"]:checked').value : '';
            var cq9 = document.querySelector('input[name="cq9"]:checked') ? document.querySelector('input[name="cq9"]:checked').value : '';
            
            var rq1 = document.querySelector('input[name="rq1"]:checked') ? document.querySelector('input[name="rq1"]:checked').value : '';
            var rq2 = document.querySelector('input[name="rq2"]:checked') ? document.querySelector('input[name="rq2"]:checked').value : '';
            var rq3 = document.querySelector('input[name="rq3"]:checked') ? document.querySelector('input[name="rq3"]:checked').value : '';
            var rq4 = document.querySelector('input[name="rq4"]:checked') ? document.querySelector('input[name="rq4"]:checked').value : '';
            var rq5 = document.querySelector('input[name="rq5"]:checked') ? document.querySelector('input[name="rq5"]:checked').value : '';
            var rq6 = document.querySelector('input[name="rq6"]:checked') ? document.querySelector('input[name="rq6"]:checked').value : '';
            var rq7 = document.querySelector('input[name="rq7"]:checked') ? document.querySelector('input[name="rq7"]:checked').value : '';
            var rq8 = document.querySelector('input[name="rq8"]:checked') ? document.querySelector('input[name="rq8"]:checked').value : '';
            var rq9 = document.querySelector('input[name="rq9"]:checked') ? document.querySelector('input[name="rq9"]:checked').value : '';
            var rq10 = document.querySelector('input[name="rq10"]:checked') ? document.querySelector('input[name="rq10"]:checked').value : '';
            var rq11 = document.querySelector('input[name="rq11"]:checked') ? document.querySelector('input[name="rq11"]:checked').value : '';
            
            var nq1 = document.querySelector('input[name="nq1"]:checked') ? document.querySelector('input[name="nq1"]:checked').value : '';
            var nq2 = document.querySelector('input[name="nq2"]:checked') ? document.querySelector('input[name="nq2"]:checked').value : '';
            var nq3 = document.querySelector('input[name="nq3"]:checked') ? document.querySelector('input[name="nq3"]:checked').value : '';
            var nq4 = document.querySelector('input[name="nq4"]:checked') ? document.querySelector('input[name="nq4"]:checked').value : '';
            var nq5 = document.querySelector('input[name="nq5"]:checked') ? document.querySelector('input[name="nq5"]:checked').value : '';
            var nq6 = document.querySelector('input[name="nq6"]:checked') ? document.querySelector('input[name="nq6"]:checked').value : '';
            var nq7 = document.querySelector('input[name="nq7"]:checked') ? document.querySelector('input[name="nq7"]:checked').value : '';
            var nq8 = document.querySelector('input[name="nq8"]:checked') ? document.querySelector('input[name="nq8"]:checked').value : '';
            var nq9 = document.querySelector('input[name="nq9"]:checked') ? document.querySelector('input[name="nq9"]:checked').value : '';
            var nq10 = document.querySelector('input[name="nq10"]:checked') ? document.querySelector('input[name="nq10"]:checked').value : '';
            var nq11 = document.querySelector('input[name="nq11"]:checked') ? document.querySelector('input[name="nq11"]:checked').value : '';
            var nq12 = document.querySelector('input[name="nq12"]:checked') ? document.querySelector('input[name="nq12"]:checked').value : '';
            var nq13 = document.querySelector('input[name="nq13"]:checked') ? document.querySelector('input[name="nq13"]:checked').value : '';
            var nq14 = document.querySelector('input[name="nq14"]:checked') ? document.querySelector('input[name="nq14"]:checked').value : '';
            var nq15 = document.querySelector('input[name="nq15"]:checked') ? document.querySelector('input[name="nq15"]:checked').value : '';
            var nq16 = document.querySelector('input[name="nq16"]:checked') ? document.querySelector('input[name="nq16"]:checked').value : '';
            var nq17 = document.querySelector('input[name="nq17"]:checked') ? document.querySelector('input[name="nq17"]:checked').value : '';
            var nq18 = document.querySelector('input[name="nq18"]:checked') ? document.querySelector('input[name="nq18"]:checked').value : '';
            var nq19 = document.querySelector('input[name="nq19"]:checked') ? document.querySelector('input[name="nq19"]:checked').value : '';

            // Afficher les réponses sur la page
            document.getElementById('reponse-satisfaction_q1').textContent = satisfaction_q1 !== null ? satisfaction_q1 : 'Non répondu';
            document.getElementById('reponse-satisfaction_q2').textContent = satisfaction_q2 !== null ? satisfaction_q2 : 'Non répondu';
            document.getElementById('reponse-produit_q1').textContent = produit_q1 !== null ? produit_q1 : 'Non répondu';
            document.getElementById('reponse-produit_q2').textContent = produit_q2 !== null ? produit_q2 : 'Non répondu';
            document.getElementById('reponse-recommandation_q1').textContent = recommandation_q1 !== null ? recommandation_q1 : 'Non répondu';
            document.getElementById('reponse-recommandation_q2').textContent = recommandation_q2 !== null ? recommandation_q2 : 'Non répondu';
        });

        function exporterImage() {
            html2canvas(document.getElementById('recapitulatif')).then(canvas => {
                var link = document.createElement('a');
                link.download = 'recapitulatif.png';
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        function exporterCSV() {
            var satisfaction_q1 = localStorage.getItem('satisfaction_q1');
            var satisfaction_q2 = localStorage.getItem('satisfaction_q2');
            var produit_q1 = localStorage.getItem('produit_q1');
            var produit_q2 = localStorage.getItem('produit_q2');
            var recommandation_q1 = localStorage.getItem('recommandation_q1');
            var recommandation_q2 = localStorage.getItem('recommandation_q2');

            var csvContent = "data:text/csv;charset=utf-8,";
            csvContent += "Catégorie,Question,Réponse\n";
            csvContent += "Satisfaction,Question 1," + (satisfaction_q1 !== null ? satisfaction_q1 : 'Non répondu') + "\n";
            csvContent += "Satisfaction,Question 2," + (satisfaction_q2 !== null ? satisfaction_q2 : 'Non répondu') + "\n";
            csvContent += "Produit,Question 1," + (produit_q1 !== null ? produit_q1 : 'Non répondu') + "\n";
            csvContent += "Produit,Question 2," + (produit_q2 !== null ? produit_q2 : 'Non répondu') + "\n";
            csvContent += "Recommandation,Question 1," + (recommandation_q1 !== null ? recommandation_q1 : 'Non répondu') + "\n";
            csvContent += "Recommandation,Question 2," + (recommandation_q2 !== null ? recommandation_q2 : 'Non répondu') + "\n";

            var encodedUri = encodeURI(csvContent);
            var link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', 'recapitulatif.csv');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html>
