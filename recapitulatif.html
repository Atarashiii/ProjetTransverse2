<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Récapitulatif des Réponses</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <header>
        <h1>Récapitulatif des Réponses</h1>
    </header>
    <main>
        <div id="recapitulatif">
            <h2>Catégorie : Satisfaction</h2>
            <p>Question 1 : <span id="reponse-satisfaction_q1"></span></p>
            <p>Question 2 : <span id="reponse-satisfaction_q2"></span></p>
            <h2>Catégorie : Produit</h2>
            <p>Question 1 : <span id="reponse-produit_q1"></span></p>
            <p>Question 2 : <span id="reponse-produit_q2"></span></p>
            <h2>Catégorie : Recommandation</h2>
            <p>Question 1 : <span id="reponse-recommandation_q1"></span></p>
            <p>Question 2 : <span id="reponse-recommandation_q2"></span></p>
        </div>
        <button onclick="exporterImage()">Exporter en Image</button>
        <button onclick="exporterCSV()">Exporter en CSV</button>
    </main>
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            // Récupérer les réponses du localStorage
            var satisfaction_q1 = localStorage.getItem('satisfaction_q1');
            var satisfaction_q2 = localStorage.getItem('satisfaction_q2');
            var produit_q1 = localStorage.getItem('produit_q1');
            var produit_q2 = localStorage.getItem('produit_q2');
            var recommandation_q1 = localStorage.getItem('recommandation_q1');
            var recommandation_q2 = localStorage.getItem('recommandation_q2');

            // Afficher les réponses sur la page
            document.getElementById('reponse-satisfaction_q1').textContent = satisfaction_q1 !== null ? satisfaction_q1 : 'Non répondu';
            document.getElementById('reponse-satisfaction_q2').textContent = satisfaction_q2 !== null ? satisfaction_q2 : 'Non répondu';
            document.getElementById('reponse-produit_q1').textContent = produit_q1 !== null ? produit_q1 : 'Non répondu';
            document.getElementById('reponse-produit_q2').textContent = produit_q2 !== null ? produit_q2 : 'Non répondu';
            document.getElementById('reponse-recommandation_q1').textContent = recommandation_q1 !== null ? recommandation_q1 : 'Non répondu';
            document.getElementById('reponse-recommandation_q2').textContent = recommandation_q2 !== null ? recommandation_q2 : 'Non répondu';
        });

        function exporterImage() {
            html2canvas(document.getElementById('recapitulatif')).then(canvas => {
                var link = document.createElement('a');
                link.download = 'recapitulatif.png';
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        function exporterCSV() {
            var satisfaction_q1 = localStorage.getItem('satisfaction_q1');
            var satisfaction_q2 = localStorage.getItem('satisfaction_q2');
            var produit_q1 = localStorage.getItem('produit_q1');
            var produit_q2 = localStorage.getItem('produit_q2');
            var recommandation_q1 = localStorage.getItem('recommandation_q1');
            var recommandation_q2 = localStorage.getItem('recommandation_q2');

            var csvContent = "data:text/csv;charset=utf-8,";
            csvContent += "Catégorie,Question,Réponse\n";
            csvContent += "Satisfaction,Question 1," + (satisfaction_q1 !== null ? satisfaction_q1 : 'Non répondu') + "\n";
            csvContent += "Satisfaction,Question 2," + (satisfaction_q2 !== null ? satisfaction_q2 : 'Non répondu') + "\n";
            csvContent += "Produit,Question 1," + (produit_q1 !== null ? produit_q1 : 'Non répondu') + "\n";
            csvContent += "Produit,Question 2," + (produit_q2 !== null ? produit_q2 : 'Non répondu') + "\n";
            csvContent += "Recommandation,Question 1," + (recommandation_q1 !== null ? recommandation_q1 : 'Non répondu') + "\n";
            csvContent += "Recommandation,Question 2," + (recommandation_q2 !== null ? recommandation_q2 : 'Non répondu') + "\n";

            var encodedUri = encodeURI(csvContent);
            var link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', 'recapitulatif.csv');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html>
